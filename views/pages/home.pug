extends ../base.pug

block variables
  - var template = 'home'


block content
  .home(data-background="#6a6a6a" data-color="#fff")
    .home__wrapper

      .home__hero
        h2.home__intro__title(data-animation="title")!=home.data.title.replace(/\n/g, '<br>')

      .home__hero(style="font-size: 22px; line-height: 32px")
        //- - const calendar_events = [{ pr: { ed: "2021-10-22", et: [ { text: "xx"} ]}}, { pr: { ed: "2021-10-23", et: [ { text: "yy"} ]}}, { pr: { ed: "2021-12-25", et: [ { text: "Xmas"} ]}}, { pr: { ed: "2022-01-01", et: [ { text: "New Year's Day"} ]}} ];
        - const getYear = event => event.event_date.split("-")[0];
        - const getMonth = event => Number(event.event_date.split("-", 2).pop());
        - const getDay = event => event.event_date.split("-")[2];
        - const months = ['dummy','jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'];

        -  let current = { year: getYear(calendar_events[0]), month: 0 };
        - const incCurrent = () => { 
        -   if (current.month==12) {
        -     current.month = 1; current.year++;
        -   } else current.month++;
        - }
        - for (let i=0; i<calendar_events.length; i++) {
        -   let month = getMonth(calendar_events[i]);
        -   if (current.month != month)
        -     while (current.month != month) incCurrent(current);
          strong New Month #{months[month]}-#{getYear(calendar_events[i])}
          .events__group(data-month=months[month] data-year=getYear(calendar_events[i]))
            p #{getDay(calendar_events[i])} - #{calendar_events[i].event_title}
            while i<calendar_events.length-1 && getMonth(calendar_events[i+1])==current.month
              - i++;
              p #{getDay(calendar_events[i])} - #{calendar_events[i].event_title}
        - }


      include ../partials/footer
